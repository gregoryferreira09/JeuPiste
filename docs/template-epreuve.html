<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title id="page-title">Quête - Jeu de piste</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&family=Cormorant+Garamond:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles/style.css">
  <style>
    .visually-hidden { position: absolute !important; height: 1px; width: 1px; overflow: hidden; clip: rect(1px,1px,1px,1px); white-space: nowrap; border: 0; padding: 0; margin: -1px; }
    .grayed { opacity: 0.5; pointer-events: none; }
    .main-btn[disabled] { opacity: 0.6; cursor: not-allowed; }
    .main-btn.enabled { background: #e0c185; color: #231d1d; font-weight: bold; }
    .actions-row-horizontal { display: flex; align-items: center; gap: 24px; margin: 24px 0; }
    .icon-action { display: flex; flex-direction: column; align-items: center; width: 90px; }
    .icon-action label, .icon-action a { cursor: pointer; }
    .modal-toast { display: none; position: fixed; left: 50%; top: 10%; transform: translateX(-50%); background: #231d1d; color: #ffeecb; border: 2px solid #e0c185; border-radius: 8px; padding: 16px 28px; font-size: 1.14em; z-index: 9999; box-shadow: 0 4px 22px #0006; text-align:center; max-width: 90vw; }
    .modal-toast.visible { display: block; animation: fadein 0.3s;}
    @keyframes fadein { from { opacity: 0; } to { opacity: 1; }}
  </style>
</head>
<body>
  <header>
    <h1 class="site-title">Jeu de piste</h1>
  </header>
  <div class="center-wrapper">
    <main class="main-accueil" id="main-content" role="main">

      <!-- TITRE ET METAPHORE UNIQUES (corrigé) -->
      <h2 class="titre-course" id="titre-quete"></h2>
      <div class="presentation-jeu" style="margin-top:24px;">
        <div class="texte-course" id="metaphore-quete" style="font-size:1.16em; color:#ffeecb; margin-bottom: 18px; line-height:1.7; font-style:italic;"></div>
      </div>
      <!-- /TITRE ET METAPHORE UNIQUES -->

      <div class="objectif-course" id="objectif-block" style="display:none;">
        <div class="objectif-label">Objectif</div>
        <div class="objectif-text" id="objectif-text"></div>
      </div>
      <div class="objectif-course" id="defi-block" style="display:none;background: #251a1a;">
        <div class="objectif-label" style="background:#cba55a; color:#231d1d;">Défi</div>
        <div class="objectif-text" id="defi-text"></div>
      </div>
      <!-- Bloc GPS -->
      <div id="bloc-gps" style="display:none;">
        <div class="actions-row-horizontal">
          <div class="icon-action side-icon">
            <a id="gps-link" href="#" target="_blank" rel="noopener">
              <!-- SVG harmonisé -->
              <svg viewBox="0 0 24 24" width="32" height="32">
                <path fill="currentColor" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm1-13h-2v6l5 2.5.76-1.85-3.76-1.65V7z"/>
              </svg>
              <span>Boussole</span>
            </a>
          </div>
          <div style="flex:1;text-align:center;">
            <button id="check-gps" class="main-btn" style="margin-top:10px;">Je suis arrivé !</button>
            <div id="gps-feedback"></div>
          </div>
        </div>
      </div>
      <!-- Bloc Mission (consigne courante) -->
      <div id="bloc-mission" style="display:none;">
        <div class="objectif-course">
          <div class="objectif-label" id="mission-label">Mission</div>
          <div class="objectif-text" id="mission-text"></div>
        </div>
      </div>
      <!-- Bloc Upload (photo, audio, etc) -->
      <div id="bloc-upload" style="display:none;">
        <div class="actions-row-horizontal" id="upload-row"></div>
        <div id="upload-feedback"></div>
      </div>
      <!-- Bloc Réponse (input pour anagramme, réponse libre, etc) -->
      <div id="bloc-answer" style="display:none;"></div>
      <!-- Bloc Indice (modale) -->
      <div id="bloc-indice" style="display:none;">
        <button id="show-indice" type="button">Voir l’indice</button>
        <div id="indice-modal" style="display:none;">
          <div class="modal-img-wrapper">
            <button class="close-modal" id="close-indice" aria-label="Fermer l’indice">&times;</button>
            <img id="indice-img" src="" alt="Indice visuel" style="display:none;">
            <div id="indice-text" style="margin-top:12px;"></div>
          </div>
        </div>
      </div>
      <!-- Bloc Chrono (si besoin) -->
      <div id="bloc-chrono" style="display:none;">
        <span class="chrono-timer" id="timer"></span>
        <span class="chrono-message" id="chrono-message"></span>
      </div>
      <!-- Bloc Pendu (mini-jeu) -->
      <div id="bloc-pendu" style="display:none;"></div>
      <!-- Bouton validation -->
      <button id="next-quest" class="main-btn" style="display:none;" disabled>Quête suivante</button>
    </main>
  </div>
  <footer class="footer">
    <p>© 2025 Jeu de piste. Tous droits réservés.</p>
    <a href="mentions-legales.html">Mentions légales</a>
  </footer>
  <div class="modal-toast" id="toast-message" role="alert" aria-live="assertive"></div>
  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>
  <!-- Catalogue des phrases -->
  <script src="JS/catalogue-phrases.js"></script>
  <!-- Catalogue des atmosphères (à ajouter si ce n'est pas déjà fait) -->
  <script src="JS/catalogue-atmospheres.js"></script>
  <!-- Script principal de gestion de l'épreuve -->
  <script src="JS/template-epreuve.js"></script>
</body>
</html>
